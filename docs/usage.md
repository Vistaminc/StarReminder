# 📖 使用教程

<div align="center">
  <a href="../README.md">返回首页</a> · <a href="installation.md">安装指南</a> · <a href="configuration.md">配置指南</a>
</div>

---

## 🎯 快速上手

### 第一次启动

1. **以管理员身份运行** `StarReminder.exe`
2. 首次启动会自动创建配置文件
3. 主界面显示三个默认监控项：
   - 📹 媒体捕获（摄像头/麦克风）
   - 🖥️ 屏幕捕获
   - 🎮 远程桌面

4. 点击右上角的**开关**启用监控

> [!TIP]
> 建议先保持默认配置，熟悉功能后再自定义。

---

## 🎨 界面导览

### 主窗口

```
┌─────────────────────────────────────────────┐
│  StarReminder                    [_][□][×] │
│  ┌───────────┐  ┌────────┐      [⚙️]  [🔄] │
│  │ 系统状态  │  │ 监控:开│                  │
│  └───────────┘  └────────┘                  │
├─────────────────────────────────────────────┤
│                                             │
│  📹 媒体捕获                                │
│     状态: 未检测到                          │
│     运行时间: --:--:--                      │
│     [配置] [详情]                           │
│                                             │
│  🖥️ 屏幕捕获                                │
│     状态: 未检测到                          │
│     运行时间: --:--:--                      │
│     [配置] [详情]                           │
│                                             │
│  🎮 远程桌面                                │
│     状态: 未检测到                          │
│     运行时间: --:--:--                      │
│     [配置] [详情]                           │
│                                             │
├─────────────────────────────────────────────┤
│  📋 活动日志                                │
│  [2025-11-01 15:30:00] 系统启动           │
│  [2025-11-01 15:30:05] 监控已启用         │
└─────────────────────────────────────────────┘
```

### 按钮说明

| 按钮 | 功能 |
|------|------|
| ⚙️ 设置 | 打开设置窗口 |
| 🔄 刷新 | 手动刷新状态 |
| 配置 | 配置该进程的监控参数 |
| 详情 | 查看进程详细信息 |

---

## 🔔 通知系统

### Defender 样式通知

当检测到目标进程时，会弹出模仿 Windows 安全中心的通知：

```
┌─────────────────────────────────────────┐
│ 🛡️ Windows 安全中心                     │
├─────────────────────────────────────────┤
│ 检测到媒体捕获程序                      │
│ 正在使用摄像头或麦克风                  │
│                                         │
│ 时间: 2025-11-01 15:30:10              │
└─────────────────────────────────────────┘
```

**特点**:
- 显示为"Windows 安全中心"
- 使用盾牌图标
- 点击可查看详情

### Native Toast 通知

使用系统原生通知：

```
┌─────────────────────────────────────────┐
│ StarReminder                            │
├─────────────────────────────────────────┤
│ 进程启动通知                            │
│ 检测到目标进程启动                      │
└─────────────────────────────────────────┘
```

### 持续水印提醒

当启用 `EnableContinuousAlert` 时，会在屏幕上显示持续水印：

```
屏幕右下角:
┌─────────────────┐
│ 摄像头/麦克风   │
│ 正在使用中      │
└─────────────────┘
```

**特点**:
- 半透明显示
- 不可关闭（进程结束后自动消失）
- 可自定义位置、颜色、透明度

## ⚙️ 常用操作

### 启用/禁用监控

**方法一：主界面开关**

1. 点击右上角开关按钮
2. 绿色 = 已启用，灰色 = 已禁用

**方法二：系统托盘（计划功能）**

1. 右键托盘图标
2. 选择"启用监控"或"禁用监控"

### 查看进程详情

1. 点击进程卡片上的"详情"按钮
2. 弹出详情窗口，显示：
   - 进程 ID
   - 启动时间
   - 运行时长
   - 媒体设备使用情况
   - 内存占用
   - CPU 占用

### 配置进程监控

1. 点击进程卡片上的"配置"按钮
2. 修改监控参数：
   - 最大运行时间
   - 超时后操作
   - 通知方式
   - 水印设置
3. 点击"保存"应用更改

### 手动控制进程

**挂起进程**:
1. 右键进程卡片
2. 选择"挂起进程"
3. 进程暂停运行，但不退出

**恢复进程**:
1. 右键已挂起的进程
2. 选择"恢复进程"
3. 进程继续运行

**终止进程**:
1. 右键进程卡片
2. 选择"终止进程"
3. 确认后强制结束进程

> [!WARNING]
> 终止进程可能导致数据丢失，请谨慎操作。

### 查看日志

**主界面日志**:
- 底部显示最近的活动日志
- 自动滚动显示最新记录

**完整日志文件**:
- 位置: `logs/activity_log.json`
- 格式: JSON
- 可用文本编辑器打开

**日志筛选**:
1. 点击"日志"菜单
2. 选择筛选条件：
   - 时间范围
   - 日志级别
   - 进程类型
3. 查看筛选结果

### 导出日志

1. 点击"日志" → "导出"
2. 选择导出格式：
   - JSON（原始格式）
   - CSV（表格格式）
   - TXT（纯文本）
3. 选择保存位置
4. 点击"导出"

---

## 🎨 自定义设置

### 主题切换

1. 点击⚙️设置按钮
2. 选择"外观"选项卡
3. 选择主题模式：
   - 浅色
   - 深色
   - 跟随系统

### 开机自启动

**方法一：应用设置**

1. 点击⚙️设置按钮
2. 选择"常规"选项卡
3. 勾选"开机自启动"

**方法二：任务计划程序**

参考 [安装指南 - 配置开机自启动](installation.md#-配置开机自启动)

### 通知设置

1. 点击⚙️设置按钮
2. 选择"通知"选项卡
3. 配置通知选项：
   - 启用/禁用系统托盘通知
   - 启用/禁用启动弹窗
   - 通知音效（计划功能）

### 高级设置

1. 点击⚙️设置按钮
2. 选择"高级"选项卡
3. 配置高级选项：
   - 监控检测间隔
   - 日志保留天数
   - 自动清理日志
   - 检查更新

---

## 🔧 故障排除

### 问题 1: 无法检测到摄像头使用

**可能原因**:
- 未以管理员权限运行
- Windows 隐私设置限制

**解决方案**:

1. 确认以管理员身份运行
2. 检查 Windows 隐私设置：
   ```
   设置 → 隐私和安全性 → 摄像头
   确保"允许应用访问摄像头"已启用
   ```

3. 测试检测功能：
   - 打开 Windows 相机应用
   - 查看 StarReminder 是否检测到
   - 检查日志文件

### 问题 2: 通知不显示

**解决方案**:

1. 检查 Windows 通知设置：
   ```
   设置 → 系统 → 通知
   确保通知已启用
   ```

2. 检查 ToastNotifier.exe：
   - 确认文件存在
   - 以管理员身份手动运行测试

3. 查看日志错误信息

### 问题 3: 进程挂起后无法恢复

**解决方案**:

1. 手动恢复：
   - 右键进程 → 恢复进程
   
2. 使用任务管理器：
   - 打开任务管理器
   - 找到挂起的进程
   - 结束进程树

3. 重启 StarReminder

### 问题 4: 配置修改不生效

**解决方案**:

1. 检查 JSON 格式：
   - 使用 JSON 验证器检查语法
   
2. 查看日志：
   - 查找"配置加载失败"错误
   
3. 重启程序：
   - 退出 StarReminder
   - 重新以管理员身份运行

### 问题 5: CPU 占用过高

**解决方案**:

1. 调整监控间隔：
   ```json
   {
     "MonitorInterval": 2
   }
   ```

2. 禁用详细日志：
   ```json
   {
     "EnableDetailedLogging": false
   }
   ```

3. 减少监控进程数量

---

## 💡 使用技巧

### 技巧 1: 快速禁用单个监控项

直接编辑 `config.json`，将 `IsEnabled` 设为 `false`：

```json
{
  "ProcessName": "process.exe",
  "IsEnabled": false
}
```

### 技巧 2: 设置进程白名单

将 `MaxRuntime` 设为 `"00:00:00"` 且 `ActionType` 为 `"none"`：

```json
{
  "MaxRuntime": "00:00:00",
  "ActionType": "none",
  "Alert": {
    "EnableStartupNotification": true
  }
}
```

### 技巧 3: 批量添加监控进程

复制配置模板，修改 `ProcessName` 和 `DisplayName`：

```json
{
  "Processes": [
    {"ProcessName": "app1.exe", "DisplayName": "应用1", ...},
    {"ProcessName": "app2.exe", "DisplayName": "应用2", ...},
    {"ProcessName": "app3.exe", "DisplayName": "应用3", ...}
  ]
}
```

### 技巧 4: 使用变量

水印文字支持变量（计划功能）：

```json
{
  "WatermarkText1": "运行时间: {runtime}",
  "WatermarkText2": "进程: {processname}"
}
```

### 技巧 5: 导出配置模板

1. 配置好一个进程
2. 复制该进程的 JSON 配置
3. 保存为模板文件
4. 后续快速应用

---

## 📚 最佳实践

### 1. 合理设置运行时间限制

- **摄像头/麦克风**: 10-15 分钟
- **屏幕录制**: 5-10 分钟
- **远程桌面**: 15-30 分钟
- **游戏**: 1-2 小时

### 2. 选择合适的通知类型

- **重要通知**: Defender 样式（权威感）
- **一般通知**: Native 样式（稳定性）
- **持续提醒**: 启用水印

### 3. 定期检查日志

- 每周查看一次日志
- 分析进程使用模式
- 调整监控策略

### 4. 保持程序更新

- 启用自动检查更新
- 及时安装新版本
- 关注更新日志

### 5. 备份配置文件

定期备份 `config.json` 和 `settings.json`：

```powershell
# 创建备份
Copy-Item config.json config.json.backup
Copy-Item settings.json settings.json.backup
```

---

## 🔗 相关链接

- [配置指南](configuration.md) - 详细的配置参数说明
- [安装指南](installation.md) - 安装和部署
- [开发指南](development.md) - 自定义功能

---

<div align="center">
  <sub>需要帮助？访问 <a href="https://github.com/vistaminc/StarReminder/wiki">Wiki</a> 或提交 <a href="https://github.com/vistaminc/StarReminder/issues">Issue</a></sub>
</div>

